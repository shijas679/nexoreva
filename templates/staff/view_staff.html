{% extends 'base.html' %}
{% load static %}
{% load crispy_forms_tags %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/staff.css' %}">
{% endblock %}

{% block content %}
<div class="main-content">
  <div class="container staff-list-container">
    <!-- Page Header -->
    <div class="page-header">
      <h2>
        <i class="bi bi-people"></i>
        All Staff Members
      </h2>
      <a href="{% url 'add_staff' %}" class="btn-add-staff">
        <i class="bi bi-plus-circle"></i>
        Add New Staff
      </a>
    </div>

    <!-- Search and Filter Bar - Single Row -->
    <div class="filter-section">
      <form method="get" class="filter-form">
        <div class="filter-row">
          <!-- Search Input -->
          <div class="search-group">
            <div class="search-input-wrapper">
              <input type="text" name="search" class="search-input" placeholder="Search by Name, Email or Code" value="{{ search_query }}">
              <i class="bi bi-search search-icon"></i>
            </div>
          </div>

          <!-- Filter Dropdown -->
          <div class="filter-group">
            <select name="sort" class="filter-select">
              <option value="">All Roles</option>
              <option value="Employee" {% if selected_role == "Employee" %}selected{% endif %}>Employee</option>
              <option value="Intern" {% if selected_role == "Intern" %}selected{% endif %}>Intern</option>
            </select>
          </div>

          <!-- Action Buttons -->
          <div class="filter-actions">
            <button type="submit" class="btn-filter">
              <i class="bi bi-funnel"></i>
              Apply
            </button>
            <a href="{% url 'view_staff' %}" class="btn-reset">
              <i class="bi bi-arrow-clockwise"></i>
              Reset
            </a>
          </div>
        </div>
      </form>
    </div>

    <!-- Staff Table -->
    <div class="table-section">
      <div class="table-wrapper">
        <table class="styled-table staff-table">
          <thead>
            <tr>
              <th class="col-num">#</th>
              <th class="col-code">Staff Code</th>
              <th class="col-name">Full Name</th>
              <th class="col-role">Role</th>
              <th class="col-dept">Department</th>
              <th class="col-email">Email</th>
              <th class="col-date">Join Date</th>
              <th class="col-status">Status</th>
              <th class="col-actions">Actions</th>
            </tr>
          </thead>
          <tbody>
            {% for staff in staff_list %}
            <tr class="staff-row">
              <td class="col-num">{{ forloop.counter }}</td>
              <td class="col-code">
                <div class="staff-code-cell">{{ staff.staff_code }}</div>
              </td>
              <td class="col-name">
                <div class="staff-name-cell">{{ staff.full_name }}</div>
              </td>
              <td class="col-role">
                {% if staff.role == "Employee" %}
                  <span class="role-badge employee">{{ staff.role }}</span>
                {% else %}
                  <span class="role-badge intern">{{ staff.role }}</span>
                {% endif %}
              </td>
              <td class="col-dept">{{ staff.department }}</td>
              <td class="col-email">
                <div class="email-cell">{{ staff.email }}</div>
              </td>
              <td class="col-date date-cell">{{ staff.join_date|date:"M d, Y" }}</td>
              <td class="col-status">
                {% if staff.status == "Completed" %}
                  <span class="status-indicator completed">{{ staff.status }}</span>
                {% elif staff.status == "Ongoing" %}
                  <span class="status-indicator in-progress">{{ staff.status }}</span>
                {% else %}
                  <span class="status-indicator pending">{{ staff.status }}</span>
                {% endif %}
              </td>
              <td class="col-actions">
                <div class="action-buttons">
                  <a href="{% url 'edit_staff' staff.id %}" class="action-btn edit-btn" title="Edit Staff">
                    <i class="bi bi-pencil-square"></i>
                  </a>
                  <a href="{% url 'delete_staff' staff.id %}" class="action-btn delete-btn" title="Delete Staff" 
                     onclick="return confirm('Are you sure you want to delete this staff member?')">
                    <i class="bi bi-trash"></i>
                  </a>
                </div>
              </td>
            </tr>
            {% empty %}
            <tr>
              <td colspan="9" class="empty-state">
                <div class="empty-content">
                  <i class="bi bi-people"></i>
                  <h4>No staff members found</h4>
                  <p>Try adjusting your search criteria or add a new staff member.</p>
                  <a href="{% url 'add_staff' %}" class="btn-add-first">
                    <i class="bi bi-plus-circle"></i>
                    Add First Staff Member
                  </a>
                </div>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
{% endblock %}
