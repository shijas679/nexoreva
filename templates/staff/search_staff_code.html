{% extends 'base.html' %}
{% load static %}
{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/staff.css' %}">
{% endblock %}

{% block content %}
<div class="main-content">
  <div class="container">
    <h2>Search Staff by Code</h2>

    <div class="form-container">
      <form method="post" class="search-form">
        {% csrf_token %}
        <div class="search-input-group">
          <input type="text" name="staff_code" placeholder="Enter Staff Code" value="{{ staff_code }}" required>
          <button type="submit" class="search-btn">
            <i class="bi bi-search"></i>
            Search
          </button>
        </div>
      </form>

      {% if staff %}
      <div class="staff-card">
        <div class="staff-header">
          <h3>{{ staff.name }}</h3>
          <div class="staff-code-badge">{{ staff.staff_code }}</div>
        </div>
        
        <div class="staff-details">
          <div class="detail-item">
            <strong>Email:</strong> {{ staff.email }}
          </div>
          <div class="detail-item">
            <strong>Department:</strong> {{ staff.department }}
          </div>
        </div>

        <div class="assignment-section">
          <h4>Assign Task</h4>
          <form method="post" enctype="multipart/form-data" class="assignment-form">
            {% csrf_token %}
            {% for field in form %}
              <div class="input-group{% if field.errors %} has-error{% endif %}">
                {{ field }}
                <label for="{{ field.id_for_label }}">{{ field.label }}</label>
                {% if field.errors %}
                  <div class="error-message">{{ field.errors|striptags }}</div>
                {% endif %}
              </div>
            {% endfor %}
            <input type="hidden" name="assigned_to" value="{{ staff.id }}">
            <button type="submit" class="btn-submit">
              <i class="bi bi-plus-circle"></i>
              Add Work Assignment
            </button>
          </form>
        </div>
      </div>
      {% elif staff_code %}
      <div class="messages">
        <div class="message error">
          <i class="bi bi-exclamation-triangle"></i>
          No staff found with code "{{ staff_code }}".
          <button class="message-close" onclick="this.parentElement.remove()">Ã—</button>
        </div>
      </div>
      {% endif %}

      <a href="{% url 'view_staff' %}" class="btn-cancel">
        <i class="bi bi-arrow-left"></i>
        Back to Staff List
      </a>
    </div>
  </div>
</div>
{% endblock %}
